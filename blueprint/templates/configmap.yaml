{{- $root := . }}
{{- $name := .Release.Name }}
{{- $repos := (include "github-scaffolding.toRepoUnique" . | fromYamlArray) }}
{{- range $j, $d := $repos }}
{{- if $d.toRepo.name -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ $name }}-replace-values-{{ $j }}
  labels:
    {{- include "github-scaffolding.labels" $root | nindent 4 }}
data:
  values: |
    { "organizationName": "{{ $d.toRepo.org }}",
      "repositoryName": "{{ $d.toRepo.name }}",
      "serviceType": "{{ $root.Values.app.service.type }}",
      "servicePort": "{{ $root.Values.app.service.port }}"
    }
---
{{- end }}
{{- end }}